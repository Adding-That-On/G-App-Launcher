"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var configHandler=function(){var a="undefined"!=typeof globalThis&&globalThis||window,v=("object"===("undefined"==typeof chrome?"undefined":_typeof(chrome))&&chrome&&chrome.runtime&&chrome||"object"===("undefined"==typeof browser?"undefined":_typeof(browser))&&browser||{}).runtime.getURL("PATH").replace("/PATH","").startsWith("safari-web-extension://"),i={"3dwarehouse":"604",accounts:"79",admanager:"2",adplanner:"3",adsense:"4",adwords:"6",alerts:"10",analytics:"11",androiddevelopers:"581",androidmarket:"70",androidmarketdeveloperconsole:"63",appengine:"15",appinventor:"581",apps:"16",appsmarketplace:"17",appsstatusdashboard:"213",artproject:"18",blogdirectory:"20",blogger:"21",blogsearch:"21",bodybrowser:"298",bookmarks:"23",bookmarksbookmarkthis:"172",bookmarkslabels:"23",bookmarkslists:"23",bookmarkslistsgmarkthis:"172",books:"65",booksngramviewer:"408",browsersize:"336",calendar:"27",calendarnewevent:"28",checkout:"488",chromeextensions:"33",chromewebstore:"31",chromewebstoredeveloperdashboard:"32",code:"45",contacts:"39",currencyconverter:"55",customsearch:"42",dashboard:"43",directory:"248",docs:"48",docsnewdoc:"299",docsnewdrawing:"47",docsnewform:"329",docsnewfromtemplate:"142",docsnewpresentation:"301",docsnewspreadsheet:"300",docsuploadfiles:"48",docsviewer:"48",earth:"49",ebookstore:"72",externalkeywordtool:"182",feedburner:"53",finance:"54",friendconnect:"82",fusiontables:"58","goo.gl":"152",googlestore:"73",governmentrequests:"91",groups:"93",hottrends:"149",igoogle:"157",imagesearch:"96",imageswirl:"96",insights:"237",knol:"125",languagetools:"352",latitude:"590",lifephotoarchive:"99",mail:"59",mailgmailthis:"175",mailnewmail:"60",maps:"101",mapsmapthis:"176",merchantcenter:"104",movies:"68",music:"69",musicchina:"69",musicindia:"69",new:"1",news:"109",newsarchive:"110",notebook:"97",notebookgnotethis:"97",offers:"155",orkut:"82",pacman:"113",panoramio:"457",patentsearch:"115",phonegallery:"73",picasawebalbums:"409",places:"234",placesnewplace:"235",plus:"82",pluscircles:"83",plusgames:"729",plushangouts:"280",plusone:"82",plusphotos:"89",plusprofile:"334",postini:"725",productideas:"521",productsearch:"129",publicdataexplorer:"121",reader:"210",readerplay:"74",readersubscribe:"210",realtime:"157",recaptcha:"188",scholar:"125",searchstories:"1",sites:"405",smschannels:"664",submityourcontent:"158",support:"137",talk:"218",tasks:"140",teachparentstech:"207",trafficestimator:"182",transit:"143",translate:"144",translatortoolkit:"145",transliteration:"62",transparencyreport:"146",trends:"147",trendsforwebsites:"189",tv:"81",video:"153",voice:"154",wallet:"155",wave:"48",webelements:"45",webfonts:"61",webhistory:"407",webmastertools:"158",websearch:"157",websiteoptimizer:"367",webtoolkit:"289",youtube:"160",youtubeleanback:"162",zeitgeist:"163"};function o(e){return e.toLowerCase().replace(/[\s-]/g,"")}function r(e){var n={customServicesDatabase:{}},a={},s=[],t=[];return e.split("\n").forEach(function(e){var t,r;"focustab=false"===e&&(n.noFocusTab=!0),"openintab=false"===e&&(n.openInCurrentTab=!0),e.startsWith("userlist=")&&(s=e.replace("userlist=","").split(",").map(o)),-1!==e.indexOf("_url=")&&(t=o((r=e.split("_url="))[0]),a[t]||(a[t]={}),a[t].url=r[1]),-1!==e.indexOf("_newname=")&&(e=o((r=e.split("_newname="))[0]),a[e]||(a[e]={}),a[e].name=r[1])}),Object.keys(a).forEach(function(e){var t,r,o=a[e];!o.url||((t=o.url).startsWith("http://")||t.startsWith("https://"))&&(r=(1e4*Date.now()+Math.round(1e4*Math.random())).toString(36),i[e]=r,n.customServicesDatabase[r]={url:t,name:o.name||e},-1===s.indexOf(e)&&s.push(e))}),s.forEach(function(e){e=i[e];e&&-1===t.indexOf(e)&&t.push(e)}),0<t.length&&(n.userList=t),n}function k(n){var a=algBasics.cachePrefix+"iconDataCache",s=[];browserStorage.local.getItem(a).catch(function(){return null}).then(function(e){var r={};e&&"object"===_typeof(e)&&(r=e);for(var o=Object.keys(n),t=0;t<o.length;t++)(function(e){var t=o[e];if(r[t])return;e=n[t]||{},e=getUrlIcon(e.url,e.iconUrl).then(function(e){e&&"object"===_typeof(e)&&(r[t]=e)});s.push(e)})(t);Promise.all(s).then(function(){browserStorage.local.setItem(a,r)}),setTimeout(function(){browserStorage.local.setItem(a,r)},1e3)})}return{importSettings:function(e){return o=e,new Promise(function(t,r){var e=new a.FileReader;e.addEventListener("error",function(e){r(e)}),e.addEventListener("load",function(e){t(e.currentTarget.result)}),e.readAsText(o)}).then(function(t){try{return JSON.parse(t)}catch(e){return r(t)}}).then(function(e){if(!e||"object"!==_typeof(e))throw new Error("invalid import format");return e});var o},exportSettings:function(e){e.customServicesDatabase=algBasics.joinCustomShortcutsDatabase([e]);var t,r=new a.Blob([JSON.stringify(e)],{type:"octet/stream"}),o=URL.createObjectURL(r),n=(n=new Date,e=n.getFullYear(),r=(n.getMonth()+1).toString(),"app-launcher-settings-"+(e+"-"+(r=1===r.length?"0"+r:r)+"-"+n.getDate())+".txt");o=o,n=n,v?window.open(o,"_blank","noopener"):((t=document.createElement("a")).rel="noopener",t.download=n,t.href=o,t.style.cssText="all:initial !important;visibility: hidden !important;opacity:0 !important;pointer-events: none !important;position: fixed !important;",t.textContent=algBasics.getI18nMessage("cj_i18n_01622","Download"),document.body.appendChild(t),t.click(),setTimeout(function(){t.remove()},1e4))},cleanupSettings:function(w){return webextFlags.no_sync_settings?Promise.resolve():browserStorage.sync.get(null).catch(function(){return{}}).then(function(e){var t=w||JSON.parse(JSON.stringify(e));t.toolbarIcon&&-1!==webextFlags.custom_action_icons.indexOf(t.toolbarIcon)||delete t.toolbarIcon;var r=t.userList;if(Array.isArray(r)&&0<r.length){var o=algBasics.joinCustomShortcutsDatabase([e,w]),r=function(e,t){for(var r=0===Object.keys(t).length,o=[],n=0;n<e.length;n++){var a=e[n],a=cjgShortcuts.legacyShortcuts[a]||a;-1===o.indexOf(a)&&(cjgShortcuts.list[a]||r||t[a])&&o.push(a)}return o}(t.userList,o);t.userList=r;for(var n=Object.keys(o),a=0;a<n.length;a++){var s,i=n[a];-1===r.indexOf(i)?delete o[i]:(s=algBasics.cleanCustomShortcutData(o[i]),o[i]=s)}k(o),algBasics.splitCustomShortcutsDatabase(o,t),browserStorage.local.set({algCustomShortcutsDatabase:o}),delete t.customServicesDatabase}else{var c=cjgOgs.getShortcuts({}).then(function(e){if(!Array.isArray(e))return null;for(var t,r=cjgShortcuts.gbIdToShortcutIdMap,o=[],n=e[0],a=0;a<n.length;a++)!(t=n[a][1][0].toString())||(t=r[t])&&(v&&("70"===t||"101"===t)||o.push(t));return o}).catch(function(){return null}).then(function(e){Array.isArray(e)&&(r=e)});[].push(c)}!1===t.alwaysTab&&(t.openInCurrentTab=!0),delete t.alwaysTab;for(var l=algBasics.supportedStorageKeys,u=Object.keys(t),p=0;p<u.length;p++){var h=u[p];-1===l.indexOf(h)&&delete t[h]}var d={},f=[];u=Object.keys(t);for(var b=Object.keys(e).concat(u),m=0;m<b.length;m++){var g,y=b[m];y in t?(g=t[y],JSON.stringify(g)!==JSON.stringify(e[y])&&(d[y]=g)):f.push(y)}return(0<Object.keys(d).length?browserStorage.sync.set(d):Promise.resolve()).then(function(){if(0<f.length&&!v)return browserStorage.sync.remove(f)}).then(function(){return t},function(){return t})})}}}();